import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.LinkedList;


public class DatabaseMath {
	private static Connection getPostgreSQLConnection() throws Exception {
	 	Class.forName("org.postgresql.Driver");
	//    System.out.println("Driver Loaded.");
	 	String Schema_name="glycodb";
	 	String User_name="postgres";
	 	String Password="root";
	   
	 	return DriverManager.getConnection("jdbc:postgresql://localhost:5432/"+Schema_name,User_name,Password);
	}
	
	public static int[] GetComposition(){
		Connection conn=null;
		 try{
			 conn = getPostgreSQLConnection();
			 if(conn!=null){
				 String sql = "select phosphate, sulfate, pentose, deoxyhexose,hexose,hexnac,neuac,neugc  from composition";
				 conn.setAutoCommit(false);  
				 PreparedStatement stmt = conn.prepareStatement(sql);
				 ResultSet rset = stmt.executeQuery();
				 LinkedList <Object[]> records=new LinkedList<Object[]>();
				 int cols = rset.getMetaData().getColumnCount();
				 while ( rset.next() )
			     {
							Object[] arr = new Object[cols];
						    for(int i=0; i<cols; i++){
						      arr[i] = rset.getObject(i+1);
						    }
						    records.add(arr);
						   
			      }
				 
				 for(int i=0; i<records.size();i++){
						for(int j=0; j<records.get(i).length; j++){
						//	CompositionID[i] = (String) records.get(i)[j];
							System.out.print(records.get(i)[j]+"  ");
						}
						System.out.println();
				} 
				 
			 }
			 
		 }catch (Exception e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
		 }
		 return null;
	}

	public static void main(String[] args) {
		int [] result =GetComposition();
		
		
	}
}
